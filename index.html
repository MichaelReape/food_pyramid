<!DOCTYPE html>
<html>
  <head>
    <title>Food Pyramid</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <h1>My Food Pyramid</h1>
    <div class="food-pyramid">
      <div class="layer-1" id="layer-1">
        <div class="button-box">
          <button class="increment" onclick="increment(1)">+</button>
          <button class="display" id="display1">2</button>
          <button class="decrement" onclick="decrement(1)">-</button>
        </div>
      </div>
      <div class="layer-2" id="layer-2">
        <div class="button-box">
          <button class="increment" onclick="increment(2)">+</button>
          <button class="display" id="display2">2</button>
          <button class="decrement" onclick="decrement(2)">-</button>
        </div>
      </div>
      <div class="layer-3" id="layer-3">
        <div class="button-box">
          <button class="increment" onclick="increment(3)">+</button>
          <button class="display" id="display3">3</button>
          <button class="decrement" onclick="decrement(3)">-</button>
        </div>
      </div>
      <div class="layer-4" id="layer-4">
        <div class="button-box">
          <button class="increment" onclick="increment(4)">+</button>
          <button class="display" id="display4">4</button>
          <button class="decrement" onclick="decrement(4)">-</button>
        </div>
      </div>
      <div class="layer-5" id="layer-5">
        <div class="button-box">
          <button class="increment" onclick="increment(5)">+</button>
          <button class="display" id="display5">5</button>
          <button class="decrement" onclick="decrement(5)">-</button>
        </div>
      </div>
      <div class="layer-6" id="layer-6">
        <div class="button-box">
          <button class="increment" onclick="increment(6)">+</button>
          <button class="display" id="display6">6</button>
          <button class="decrement" onclick="decrement(6)">-</button>
        </div>
      </div>
      <div class="record">
        <h1>My Food Pyramid</h1>
        <p>Enter date in dd/mm/yyyy</p>
        <input type="text" id="date" />
        <button onclick="validate(document.getElementById('date').value)">
          Enter
        </button>
      </div>
      <div class="age">
        <button onclick="setAge(0)">1-4 years old</button>
        <button onclick="setAge(1)">5+ years old</button>
      </div>
    </div>

    <script>
      var pyramidVersion = 0;

      //upper rda limits for each layer, 0 for child, 1 for 5+
      const rdaUpper = [
        [0, 0, 4, 3, 5, 6],
        [1, 1, 2, 5, 5, 7],
      ];
      //lower rda limits for each layer, 0 for child, 1 for 5+
      const rdaLower = [
        [0, 0, 2, 3, 2, 3],
        [0, 0, 2, 3, 3, 5],
      ];

      //selects which version of the pyramid you want to use
      function setAge(num) {
        pyramidVersion = num;
      }

      function validate(date) {}

      function increment(layer) {
        // grabs the needed displayid
        var layerClass = "layer-" + layer;
        var display = document.getElementById("display" + layer);
        var currentVal = parseInt(display.textContent);
        currentVal++;

        display.textContent = currentVal;

        var element = document.getElementById(layerClass);
        var style = window.getComputedStyle(element);

        if (
          currentVal > rdaUpper[pyramidVersion][layer - 1] ||
          currentVal < rdaLower[pyramidVersion][layer - 1]
        ) {
          //change color
          display.style.backgroundColor = "red";
          var increase = parseInt(style.borderBottom) + 10;

          console.log(element.style.borderRightWidth);

          element.style.borderRightWidth = increase + "px";
          element.style.borderBottomWidth = increase + "px";
          element.style.borderLeftWidth = increase + "px";

          var oldWidth = parseInt(style.width);

          var newWidth = increase * 2 + oldWidth;
          console.log("the new width should be " + oldWidth);

          updateSize(newWidth, layer);
        }
        //if current val = rda min
        //set height to default

        //height should increment until hits default
        //same with decrement
        if (currentVal == rdaLower[pyramidVersion][layer - 1]) {
          element.style.borderRightWidth = "100px";
          element.style.borderLeftWidth = "100px";
          element.style.borderBottomWidth = "100px";

          var newWidth = 200 + parseInt(style.width);
          updateSize(newWidth, layer);
        }
      }
      function decrement(layer) {
        var layerClass = "layer-" + layer;
        var display = document.getElementById("display" + layer);
        var currentVal = parseInt(display.textContent);
        currentVal--;

        //cant have negative number of meals
        if (currentVal < 0) {
          currentVal = 0;
          return;
        }
        display.textContent = currentVal;

        if (
          currentVal < rdaLower[pyramidVersion][layer - 1] ||
          currentVal > rdaUpper[pyramidVersion][layer - 1]
        ) {
          var element = document.getElementById(layerClass);
          var style = window.getComputedStyle(element);
          var decrease = parseInt(style.borderBottom) - 10;

          element.style.borderRightWidth = decrease + "px";
          element.style.borderBottomWidth = decrease + "px";
          element.style.borderLeftWidth = decrease + "px";

          var oldWidth = parseInt(style.width);

          var newWidth = decrease * 2 + oldWidth;
          updateSize(newWidth, layer);
        }
        //if currentval = rdaupper
        //set height to defualt
      }
      function updateSize(newWidth, layer) {
        //iterates from next layer and adjusts the width to keep pyramid shape
        //width = previous layer width + sides*2
        for (var i = layer + 1; i <= 6; i++) {
          var layerClass = "layer-" + i;
          var element = document.getElementById(layerClass);
          var style = window.getComputedStyle(element);

          element.style.width = newWidth + "px";
          newWidth = newWidth + parseInt(style.borderBottom) * 2;
        }
      }
    </script>
  </body>
</html>
